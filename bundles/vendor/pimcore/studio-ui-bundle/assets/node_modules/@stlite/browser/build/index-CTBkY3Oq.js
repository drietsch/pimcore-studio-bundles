import{r as s,u as v,j as T}from"./index-DDFagdcg.js";function y({element:t,width:c,endpoints:m,elementMgr:d}){const n=s.useRef(null),{startTime:u,endTime:a,loop:i,autoplay:l}=t,f=s.useMemo(()=>{if(!t.id)return!0;const e=d.getElementState(t.id,"preventAutoplay");return e||d.setElementState(t.id,"preventAutoplay",!0),e??!1},[t.id,d]);s.useEffect(()=>{n.current&&(n.current.currentTime=u)},[u]),s.useEffect(()=>{const e=n.current,r=()=>{e&&(e.currentTime=t.startTime)};return e&&e.addEventListener("loadedmetadata",r),()=>{e&&e.removeEventListener("loadedmetadata",r)}},[t]),s.useEffect(()=>{const e=n.current;if(!e)return;let r=!1;const o=()=>{a>0&&e.currentTime>=a&&(i?(e.currentTime=u||0,e.play()):r||(r=!0,e.pause()))};return a>0&&e.addEventListener("timeupdate",o),()=>{e&&a>0&&e.removeEventListener("timeupdate",o)}},[a,i,u]),s.useEffect(()=>{const e=n.current;if(!e)return;const r=()=>{i&&(e.currentTime=u||0,e.play())};return e.addEventListener("ended",r),()=>{e&&e.removeEventListener("ended",r)}},[i,u]);const p=v(t.url),E=m.buildMediaURL(p);return T.jsx("audio",{className:"stAudio","data-testid":"stAudio",ref:n,controls:!0,autoPlay:l&&!f,src:E,style:{width:c}})}export{y as default};
