import{c as R,r as d,u as M,aC as U,aQ as j,j as p}from"./index-DDFagdcg.js";const x=R("iframe",{target:"evvcert0"})(({theme:r})=>({colorScheme:"normal",border:"none",padding:r.spacing.none,margin:r.spacing.none,width:"100%",aspectRatio:"16 / 9"}),""),V=528;function A({element:r,width:m,endpoints:f,elementMgr:l}){const n=d.useRef(null),{type:y,url:E,startTime:s,subtitles:g,endTime:o,loop:u,autoplay:T,muted:L}=r,c=M(E),v=U(g),P=d.useMemo(()=>{if(!r.id)return!0;const e=l.getElementState(r.id,"preventAutoplay");return e||l.setElementState(r.id,"preventAutoplay",!0),e??!1},[r.id,l]);d.useEffect(()=>{n.current&&(n.current.currentTime=s)},[s]),d.useEffect(()=>{const e=n.current,t=()=>{e&&(e.currentTime=r.startTime)};return e&&e.addEventListener("loadedmetadata",t),()=>{e&&e.removeEventListener("loadedmetadata",t)}},[r]),d.useEffect(()=>{const e=n.current;if(!e)return;let t=!1;const i=()=>{o>0&&e.currentTime>=o&&(u?(e.currentTime=s||0,e.play()):t||(t=!0,e.pause()))};return o>0&&e.addEventListener("timeupdate",i),()=>{e&&o>0&&e.removeEventListener("timeupdate",i)}},[o,u,s]),d.useEffect(()=>{const e=n.current;if(!e)return;const t=()=>{u&&(e.currentTime=s||0,e.play())};return e.addEventListener("ended",t),()=>{e&&e.removeEventListener("ended",t)}},[u,s]);const S=e=>{const{startTime:t,endTime:i,loop:b,autoplay:w,muted:N}=r,a=new URL(e);if(t&&!isNaN(t)&&a.searchParams.append("start",t.toString()),i&&!isNaN(i)&&a.searchParams.append("end",i.toString()),b){a.searchParams.append("loop","1");const h=a.pathname.split("/").pop();h&&a.searchParams.append("playlist",h)}return w&&a.searchParams.append("autoplay","1"),N&&a.searchParams.append("mute","1"),a.toString()};return y===j.Type.YOUTUBE_IFRAME?p.jsx(x,{className:"stVideo","data-testid":"stVideo",title:c,src:S(c),allow:"autoplay; encrypted-media",allowFullScreen:!0}):p.jsx("video",{className:"stVideo","data-testid":"stVideo",ref:n,controls:!0,muted:L,autoPlay:T&&!P,src:f.buildMediaURL(c),style:{width:m,height:m===0?V:void 0},crossOrigin:void 0,children:v&&v.map((e,t)=>p.jsx("track",{kind:"captions",src:f.buildMediaURL(`${e.url}`),label:`${e.label}`,default:t===0},t))})}export{A as default};
