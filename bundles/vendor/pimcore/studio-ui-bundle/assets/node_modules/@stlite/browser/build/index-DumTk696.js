import{R as m,a5 as w,aF as u,b7 as b,j as c,aG as g,aW as y,aE as A,aH as C}from"./index-DDFagdcg.js";import{c as R}from"./createDownloadLinkElement-Dk3hYdCb.js";const T=/%([0-9A-Fa-f]{2})/g,E=/[^\x20-\x7e\xa0-\xff]/g,v=/\\([\u0000-\u007f])/g,p=/;[\x09\x20]*([!#$%&'*+.0-9A-Z^_`a-z|~-]+)[\x09\x20]*=[\x09\x20]*("(?:[\x20!\x23-\x5b\x5d-\x7e\x80-\xff]|\\[\x20-\x7e])*"|[!#$%&'*+.0-9A-Z^_`a-z|~-]+)[\x09\x20]*/g,L=/^([A-Za-z0-9!#$%&+\-^_`{}~]+)'(?:[A-Za-z]{2,3}(?:-[A-Za-z]{3}){0,3}|[A-Za-z]{4,8}|)'((?:%[0-9A-Fa-f]{2}|[A-Za-z0-9!#$&+.^_`|~-])+)$/,z=/^([!#$%&'*+.0-9A-Z^_`a-z|~-]+)[\x09\x20]*(?:$|;)/,I=n=>String(n).replace(E,"?");class ${constructor(t,e){this.type=t,this.parameters=e}}const k=(n,t)=>String.fromCharCode(Number.parseInt(t,16));function U(n){const t=L.exec(n);if(!t)throw new TypeError("invalid extended field value");const e=t[1].toLowerCase(),o=t[2];let r;switch(e){case"iso-8859-1":r=I(o.replace(T,k));break;case"utf-8":try{r=decodeURIComponent(o)}catch{throw new TypeError("invalid encoded utf-8")}break;default:throw new TypeError("unsupported charset in extended field")}return r}function Z(n){let t=z.exec(n);if(!t)throw new TypeError("invalid type format");let e=t[0].length;const o=t[1].toLowerCase();let r;const s=[],i={};let a;for(e=p.lastIndex=t[0].slice(-1)===";"?e-1:e;t=p.exec(n);){if(t.index!==e)throw new TypeError("invalid parameter format");if(e+=t[0].length,r=t[1].toLowerCase(),a=t[2],s.indexOf(r)!==-1)throw new TypeError("invalid duplicate parameter");if(s.push(r),r.indexOf("*")+1===r.length){r=r.slice(0,-1),a=U(a),i[r]=a;continue}typeof i[r]!="string"&&(a[0]==='"'&&(a=a.slice(1,a.length-1).replace(v,"$1")),i[r]=a)}if(e!==-1&&e!==n.length)throw new TypeError("invalid parameter format");return new $(o,i)}function j(n){const t=Z(n);if(t.type!=="attachment")return;const e=t.parameters.filename;if(typeof e=="string")return e}function D(n,t){n.sendHttpRequest({method:"GET",path:`${t}?title=${encodeURIComponent(document.title)}`,headers:{},body:""}).then(({statusCode:e,headers:o,body:r})=>{if(e!==200)return;const s=o.get("Content-Disposition"),i=(s&&j(s))??"",a=o.get("Content-Type"),f=new Blob([r],a?{type:a}:void 0),d=URL.createObjectURL(f),l=document.createElement("a");l.setAttribute("href",d),l.setAttribute("target","_blank"),l.setAttribute("download",i),l.click(),URL.revokeObjectURL(d),l.remove()})}function _(n,t,e){return R({enforceDownloadInNewTab:e,url:n.buildMediaURL(t),filename:""})}function N(n){const{disabled:t,element:e,widgetMgr:o,width:r,endpoints:s,fragmentId:i}=n,a={width:r},{libConfig:{enforceDownloadInNewTab:f=!1}}=m.useContext(w);let d=u.SECONDARY;e.type==="primary"?d=u.PRIMARY:e.type==="tertiary"&&(d=u.TERTIARY);const l=b(),x=()=>{if(o.setTriggerValue(e,{fromUi:!0},i),e.url.startsWith("/media")){D(l,e.url);return}_(s,e.url,f).click()},h=e.help?r:!0;return c.jsx("div",{className:"stDownloadButton","data-testid":"stDownloadButton",style:a,children:c.jsx(g,{help:e.help,children:c.jsx(y,{kind:d,size:A.SMALL,disabled:t,onClick:x,fluidWidth:e.useContainerWidth?h:!1,children:c.jsx(C,{icon:e.icon,label:e.label})})})})}export{N as default};
